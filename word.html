<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<h1>Wordle Helper</h1>
<input id="query" placeholder="*Query. Eg: a*h*"/>
<input id="exclude" placeholder="Exclude. Eg: bg"/>
<input id="yellow" placeholder="Yellow. Eg: hj"/>
<button onclick="dosearch()">search</button>
<div id="words"></div>


<script>

  function dosearch() {
    const query = document.getElementById("query").value.trim() || 0
    const yellow = document.getElementById("yellow").value.trim()
      .split('') || []
    let exclude = document.getElementById("exclude").value.trim()
      .split('')
      .filter(a => !query.includes(a))
      .filter(a => !yellow.includes(a))
      || []
    console.log({exclude})

    if (query.length !== 5) {
      document.getElementById("words").innerHTML = "query must be 5 letters";
    } else {
      fetch('https://raw.githubusercontent.com/dividezero/wordle-helper/main/words.txt')
        .then(function (response) {
          // The API call was successful!
          response.text()
            .then(starter => {
              const words = starter.split('\n');
              console.log(words);
              const regexStr = query.split('')
                .map(alphabet => alphabet === '*' ? '[a-z]' : alphabet)
                .join('')
              const regex = new RegExp(regexStr);
              let result = words.filter(word => regex.test(word))
              for(let ex of exclude){
                result = result.filter(res => !res.includes(ex))
              }
                for(let yel of yellow){
                result = result.filter(res => res.includes(yel))
              }
              const res2 = result.map(a => '<div>' + a + '</div>').join('');
              document.getElementById("query").innerHTML = query;
              document.getElementById("words").innerHTML = res2;

            })

        }).catch(function (err) {
        // There was an error
        console.warn('Something went wrong.', err);
      });
    }
  }
</script>
</body>
</html>
